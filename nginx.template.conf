worker_processes  1;
daemon off;

events { worker_connections 1024; }

http {
  include    $!{nginx}/conf/mime.types;
  default_type application/octet-stream;
  sendfile on;

  server {
    # Railway 會注入 PORT 變數，Nixpacks 用 ${PORT} 監聽
    listen ${8181};
    listen [::]:${8181};
    server_name _;

    # 前端打包輸出根目錄（Nixpacks Staticfile 預設把 app 根目錄當 root；
    # 若你的 dist 在子資料夾，直接寫絕對路徑 /app/dist 也可）
    root /Backend/dist;
    index index.html;

    # 靜態資源照檔案走
    location /assets/ {
      try_files $uri =404;
      access_log off;
    }

    # 其餘路徑全部回 index.html（BrowserRouter 刷新不 404 的關鍵）
    location / {
      try_files $uri $uri/ /index.html;
    }
  }
}
